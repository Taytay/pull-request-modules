{"name":"mention-bot","version":"3.0.2","license":"BSD-3-Clause","repository":"https://github.com/facebook/mention-bot","scripts":{"test":"flow && jest","start":"node run-server.js"},"main":"./run-mention-bot.js","engines":{"node":">=4"},"jest":{"scriptPreprocessor":"<rootDir>/node_modules/babel-jest","unmockedModulePathPatterns":["core-js/.*"]},"config":{},"dependencies":{"babel-core":"^6.0.0","babel-jest":"^6.0.1","babel-plugin-syntax-async-functions":"^6.1.4","babel-plugin-transform-object-rest-spread":"^6.1.18","babel-plugin-transform-regenerator":"^6.1.4","babel-polyfill":"^6.1.4","babel-preset-react":"^6.1.2","bl":"^1.0.0","download-file-sync":"^1.0.3","express":"^4.13.3","flow-bin":"^0.18.1","github":"^7.3.2","jest-cli":"^0.7.1","jsonlint":"^1.6.2","minimatch":"^3.0.0","node-schedule":"^1.0.0"},"gitHead":"84fdcc9a1c0057dabd0f538847a4cb3f846e33c8","description":"Do you have a GitHub project that is too big for people to subscribe to all the notifications? The mention bot will automatically mention potential reviewers on pull requests. It helps getting faster turnaround on pull requests by involving the right peop","homepage":"https://github.com/facebook/mention-bot#readme","versions":[{"number":"0.0.1","date":"2016-01-26T22:48:59.897Z"},{"number":"1.0.0","date":"2016-07-01T19:35:22.004Z"},{"number":"2.0.0","date":"2016-07-01T21:20:19.522Z"},{"number":"3.0.0","date":"2016-07-05T16:06:25.564Z"},{"number":"3.0.1","date":"2016-07-09T20:56:45.862Z"},{"number":"3.0.2","date":"2017-01-20T18:36:47.109Z"}],"readme":"# mention-bot [![Build Status](https://travis-ci.org/facebook/mention-bot.svg?branch=master)](https://travis-ci.org/facebook/mention-bot)\n\nDo you have a GitHub project that is too big for people to subscribe to all the notifications? The mention bot will automatically mention potential reviewers on pull requests. It helps getting faster turnaround on pull requests by involving the right people early on.\n\n<img width=\"769\" src=\"https://cloud.githubusercontent.com/assets/197597/11023035/a2f8733e-8622-11e5-84df-49a3d9425938.png\">\n\n## How To Use?\n\n- Go to\n - your project on GitHub > Settings > Webhooks & services > Add Webhook or\n - your organization on GitHub > Settings > Webhooks > Add Webhook\n- Payload URL: (https://mention-bot.herokuapp.com/)\n- Content type: `application/json`\n- Secret: Leave blank\n- Let me select individual events > Check `Pull Request`\n- Add Webhook\n\nAnd you are done. Next time a pull request is opened, you should see the bot add a comment ;)\n\n## Configuration\n\nThe bot can be configured by adding a `.mention-bot` file to the base directory of the repo. Here's a list of the possible options:\n\n```js\n{\n  \"maxReviewers\": 5, // Maximum  number of people to ping in the PR message, default is 3\n  \"numFilesToCheck\": 10, // Number of files to check against, default is 5\n  \"message\": \"@pullRequester, thanks! @reviewers, please review this.\",\n             // custom message using @pullRequester and @reviewers\n  \"alwaysNotifyForPaths\": [\n    {\n      \"name\": \"ghuser\", // The user's Github username\n      \"files\": [\"src/js/**/*.js\"], // The array of file globs associated with the user\n      \"skipTeamPrs\": false // mention-bot will exclude the creator's own team from mentions\n    }\n  ], // Users will always be mentioned based on file glob\n  \"fallbackNotifyForPaths\": [\n    {\n      \"name\": \"ghuser\", // The user's Github username\n      \"files\": [\"src/js/**/*.js\"], // The array of file globs associated with the user\n      \"skipTeamPrs\": false // mention-bot will exclude the creator's own team from mentions\n    }\n  ], // Users will be mentioned based on file glob if no other user was found\n  \"findPotentialReviewers\": true, // mention-bot will try to find potential reviewers based on files history, if disabled, `alwaysNotifyForPaths` is used instead\n  \"fileBlacklist\": [\"*.md\"], // mention-bot will ignore any files that match these file globs\n  \"userBlacklist\": [], // Users in this list will never be mentioned by mention-bot\n  \"userBlacklistForPR\": [], // PR made by users in this list will be ignored\n  \"requiredOrgs\": [], // mention-bot will only mention user who are a member of one of these organizations\n  \"actions\": [\"opened\"], // List of PR actions that mention-bot will listen to, default is \"opened\"\n  \"skipAlreadyAssignedPR\": false, // mention-bot will ignore already assigned PR's\n  \"skipAlreadyMentionedPR\": false, // mention-bot will ignore if there is already existing an exact mention\n  \"assignToReviewer\": false, // mention-bot assigns the most appropriate reviewer for PR\n  \"createReviewRequest\": false, // mention-bot creates review request for the most appropriate reviewer for PR\n  \"skipTitle\": \"\", // mention-bot will ignore PR that includes text in the title,\n  \"withLabel\": \"\", // mention-bot will only consider PR's with this label. Must set actions to [\"labeled\"].\n  \"delayed\": false, // mention-bot will wait to comment until specified time in `delayedUntil` value\n  \"delayedUntil\": \"3d\", // Used if delayed is equal true, permitted values are: minutes, hours, or days, e.g.: '3 days', '40 minutes', '1 hour', '3d', '1h', '10m'\n  \"skipCollaboratorPR\": false // mention-bot will ignore if PR is made by collaborator\n}\n```\n\nThe glob matching is an extended form of glob syntax performed by [`minimatch`](https://github.com/isaacs/minimatch), with the default options; read [the `minimatch` README](https://github.com/isaacs/minimatch/blob/master/README.md) for more details.\n\n**Note:** The `.mention-bot` file must be valid JSON.\n\nThe default config can be overridden via environment config. e.g.:\n\n```zsh\nMENTION_BOT_CONFIG={\"maxReviewers\":1,\"delayed\":true}\n```\n---\n\n## How Does It Work?\n\nEvery time there's a new pull request, GitHub wakes up the mention bot <img src=\"https://avatars0.githubusercontent.com/u/15710697?v=3&s=40\" width=\"20\" height=\"20\" /> using Webhooks.\n\nOnce awakened, the bot will download the diff of the pull request and figure out which files and lines have been touched.\n\n<img width=\"1139\" src=\"https://cloud.githubusercontent.com/assets/197597/11022818/92edd20e-861d-11e5-8c44-c64c1a7de79f.png\">\n\nFor these, it will download the associated blame to figure out who last touched that line, as they may be a good reviewer.\n\n<img width=\"923\" src=\"https://cloud.githubusercontent.com/assets/197597/11022820/973166aa-861d-11e5-83b1-b05e8228f974.png\">\n\nAfter running the [algorithm](#algorithm) described in the next section, it will comment on the pull request notifying those people and go back to sleep.\n\n<img width=\"769\" src=\"https://cloud.githubusercontent.com/assets/197597/11022875/3e4949de-861f-11e5-8459-573a8dbc9013.png\">\n\n## Algorithm\n\nThe problem of finding who the best reviewers are is really hard and I don't think that any algorithm will achieve perfection. Instead, what we want here is to be **best effort**. We want to notify people that are likely going to be interested and be good reviewers. If we ping a few too many people that's not the end of the world neither if we don't ping the exact right person.\n\nWe use two heuristics:\n- If a line was deleted or modified, the person that last touched that line is likely going to care about this pull request.\n- If a person last touched many lines in the file where the change was made, they will want to be notified.\n\n**Initialization**\n\nCreate two empty hash map:\n- `DeletedLines` for authors of deleted lines.\n- `AllLines` for authors of lines in the changed files.\n\n**Filling the data structures**\n\n- for each deleted line, find the author in the blame and increase its count by one in the `DeletedLines` map.\n- for each line in every file that was changed, find the author in the blame and increase its count by one in the `AllLines` map.\n\nSince getting the blame information is sending an http request to GitHub it is pretty expensive. We first sort the files by number of deleted lines and only pick the top 5. Since we're only looking for 3 names and the algorithm is best effort, this greatly speeds up the algorithm in case of large pull requests for little loss in precision.\n\n**Putting it all together**\n\n- delete from `AllLines` all the names that appear in both maps. We don't want to mention the same person twice.\n- sort each map by count\n- concat `DeletedLines` with `AllLines`\n- take the first three names\n\n## How To Contribute or Run Your Own Bot?\n\nIf you want to use a different account for the bot, change the message or extend it with more functionalities, we've tried to make it super easy:\n\n```bash\ngit clone https://github.com/facebook/mention-bot.git\ncd mention-bot\nnpm install\nnpm start\n# Follow the instructions there\n```\n\nAlternatively, click the button below:\n\n[![Deploy](https://www.herokucdn.com/deploy/button.svg)](https://heroku.com/deploy)\n\nIf you would like the mention-bot to function on private repositories, set the `GITHUB_USER` and `GITHUB_PASSWORD` environment variables. You must disable two-factor authentication or you will receive a console log like this: `Login to ${USERNAME} failed`.\n\nYou can also set a `REQUIRED_ORG` environment variable, so you don't have to configure it in each repository of your organization.\n\nYou can also build deploy it as a Docker image:\n\n```bash\ndocker build -t mention-bot .\ndocker run -e GITHUB_USER=\"a\" -p 5000:5000  mention-bot\n```\n\n## Configuring a custom message\n\nIf you want to change the default message, you can write your custom logic in [message.js](https://github.com/facebook/mention-bot/blob/master/message.js), or add 'message' in the [.mention-bot configuration](#configuration) file.\n\n## How to run the bot on GitHub Enterprise\n\nIf you want to run the bot on your GitHub Enterprise instance, add the GHE host and path prefix to the config section of package.json\n\n```json\n\"config\": {\n  \"gheHost\": \"github.my-GHE-enabled-company.com\",\n  \"ghePathPrefix\": \"/api/v3\"\n}\n```\n\nIf you use `http` protocol, the config section like this:\n\n```json\n\"config\": {\n  \"gheHost\": \"github.my-GHE-enabled-company.com\",\n  \"ghePathPrefix\": \"/api/v3\",\n  \"gheProtocol\": \"http\",\n  \"ghePort\": 80\n}\n```\n\n\n## Programmatic API\n\nWhen you require `mention-bot` you will get all the functions exposed by [`mention-bot.js`](https://github.com/facebook/mention-bot/blob/master/mention-bot.js) module. You are expected to manage your own server and also connection to the github repository.\n\n```\nnpm install mention-bot github\n```\n\nAPI can be used like this:\n\n```js\nvar mentionBot = require('mention-bot');\nvar GitHubApi = require('github');\n\nvar github = new GitHubApi({ version: '3.0.0' });\ngithub.authenticate({\n  type: 'oauth',\n  token: '...token...'\n});\n\nmentionBot\n  .guessOwnersForPullRequest(\n    'https://github.com/fbsamples/bot-testing', // repo\n    65, // pull request number\n    'mention-bot', // user that created the pull request\n    'master', // branch\n    { maxReviewers: 3 }, // config\n    github\n  )\n  .then(function(users) {\n    // array with user names which should be included in review\n    console.log(users);\n  })\n  .catch(function(err) {\n    console.error(err);\n  });\n```\n\n## License\n\nmention-bot is [BSD-licensed](https://github.com/facebook/mention-bot/blob/master/LICENSE). We also provide an [additional patent grant](https://github.com/facebook/mention-bot/blob/master/PATENTS).\n","created":"2016-01-26T22:48:59.897Z","modified":"2017-01-20T18:36:47.109Z","lastPublisher":{"name":"vjeux","email":"vjeuxx@gmail.com"},"owners":[{"name":"vjeux","email":"vjeuxx@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"mention-bot","_nodeVersion":"4.7.2","_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/mention-bot-3.0.2.tgz_1484937406868_0.6216752352192998"},"_npmUser":{"name":"vjeux","email":"vjeuxx@gmail.com"},"_npmVersion":"2.15.11","_rev":"2-7e91d4a8fd2139befebb27da6d45c9ef","_shasum":"25f6e9eea93fce27514b8a2b07b0798efb9b7dc7","bugs":{"url":"https://github.com/facebook/mention-bot/issues"},"directories":{},"dist-tags":{"latest":"3.0.2"},"dist":{"shasum":"25f6e9eea93fce27514b8a2b07b0798efb9b7dc7","tarball":"https://registry.npmjs.org/mention-bot/-/mention-bot-3.0.2.tgz"},"maintainers":[{"name":"vjeux","email":"vjeuxx@gmail.com"}],"readmeFilename":"README.md","time":{"modified":"2017-01-20T18:36:47.109Z","created":"2016-01-26T22:48:59.897Z","0.0.1":"2016-01-26T22:48:59.897Z","1.0.0":"2016-07-01T19:35:22.004Z","2.0.0":"2016-07-01T21:20:19.522Z","3.0.0":"2016-07-05T16:06:25.564Z","3.0.1":"2016-07-09T20:56:45.862Z","3.0.2":"2017-01-20T18:36:47.109Z"}}}